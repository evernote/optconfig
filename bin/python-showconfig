#!/usr/bin/env python

import sys
import json
import optconfig

print "Using {}".format(optconfig.__file__)

sys.argv.reverse()                  # Ugh. Ugh.
script = sys.argv.pop()
domain = sys.argv.pop()
optspectext = sys.argv.pop()
sys.argv.append(script)             # Ugh.
sys.argv.reverse()                  # Ugh.

optspec = json.loads(optspectext)

opt = optconfig.optconfig(domain, optspec)

print json.dumps(opt.dict())
